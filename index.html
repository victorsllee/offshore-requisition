<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kitchen Requisition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .sticky-header { position: sticky; top: 0; z-index: 40; }
        input[type="checkbox"] { transform: scale(1.2); }
        .tab-active { border-bottom: 3px solid #2563eb; color: #2563eb; font-weight: bold; }
        .qty-input { width: 75px; text-align: center; border: 1px solid #d1d5db; border-radius: 4px; padding: 4px; font-weight: bold; color: #1d4ed8; }
        input[type="text"] { font-size: 16px; } 
        .category-header { background: #1e3a8a; color: white; padding: 8px 12px; font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.1em; margin-top: 20px; border-radius: 8px 8px 0 0; }
        .item-row { background: white; border: 1px solid #e5e7eb; border-top: none; }
        .item-row:last-child { border-radius: 0 0 8px 8px; }
        
        /* Custom Modal Styling */
        #refresh-modal { display: none; }
    </style>
</head>
<body class="bg-gray-100 pb-32">

    <div class="bg-white shadow-md sticky-header p-4">
        <h1 class="text-xl font-bold text-center mb-3 text-gray-800">Inventory Check / Ki·ªÉm Kho</h1>
        
        <div class="flex justify-around mb-4 border-b">
            <button id="btn-kitchen" class="pb-2 px-4 tab-active transition-all" onclick="switchTab('kitchen')">Kitchen / B·∫øp</button>
            <button id="btn-floor" class="pb-2 px-4 text-gray-500 transition-all" onclick="switchTab('floor')">Floor & Bar</button>
        </div>

        <div class="relative">
            <input type="text" id="searchInput" onkeyup="filterItems()" placeholder="Search item / T√¨m m√≥n..." 
                   class="w-full p-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50">
        </div>
    </div>

    <div id="inventory-list" class="max-w-md mx-auto p-2">
        <!-- Manual Sorted List will be injected here -->
    </div>

    <!-- Fixed Action Bar -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t p-4 shadow-lg flex items-center justify-between z-50">
        <div class="flex flex-col">
            <span class="text-[10px] text-gray-400 uppercase font-black tracking-widest">Selected</span>
            <span id="selected-count" class="text-2xl text-blue-600 font-black leading-none">0</span>
        </div>
        <button onclick="generateOrder()" class="bg-blue-600 text-white px-8 py-4 rounded-xl font-bold active:bg-blue-700 transition transform active:scale-95 shadow-xl">
            SEND REQUISITION
        </button>
    </div>

    <!-- Refresh Warning Dialog (Triggered on manual refresh attempt if possible) -->
    <div id="refresh-modal" class="fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
            <h3 class="text-lg font-bold mb-2">C·∫£nh B√°o</h3>
            <p class="text-gray-600 mb-6 text-sm">L√†m m·ªõi trang s·∫Ω x√≥a h·∫øt c√°c m·ª•c ƒë√£ ch·ªçn. B·∫°n c√≥ mu·ªën ti·∫øp t·ª•c?</p>
            <div class="flex space-x-3">
                <button onclick="closeModal()" class="flex-1 bg-blue-600 text-white py-3 rounded-xl font-bold">Quay l·∫°i</button>
                <button onclick="location.reload()" class="flex-1 bg-gray-200 text-gray-800 py-3 rounded-xl font-bold">Ti·∫øp t·ª•c</button>
            </div>
        </div>
    </div>

    <script>
        // DATA SORTED BY FREQUENCY OF REPLENISHMENT (FROM MD)
        const kitchenData = [
            // PRODUCE
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "B√¥ng c·∫£i xanh / Broccoli", unit: "kg", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "B√¥ng c·∫£i tr·∫Øng / Cauliflower", unit: "kg", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "ƒê·∫≠u qu√™ / Green beans", unit: "kg", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C√† r·ªët / Carrots", unit: "kg", qty: 10 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "B·∫Øp c·∫£i / Cabbage", unit: "C√°i", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "X√† l√°ch batavia / Batavia lettuce", unit: "C·ªçng", qty: 5 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C√† chua b√©t ch√≠n / Beef tomatoes", unit: "Kg", qty: 3 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C√† chua b√≠ (b·ªãch 1kg) / Cherry tomatoes", unit: "B·ªãch", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·ªß h√†nh t√¢y to / Large onions", unit: "kg", qty: 5 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·ªß h√†nh t√¢y t√≠m / Shallots", unit: "VNƒê", qty: "10k" },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·ªß h√†nh t√¢y nh·ªè / Small onions", unit: "C·ªß", qty: 50 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "Khoai t√¢y v·ªè tr·∫Øng / White potatoes", unit: "kg", qty: 5 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "Khoai t√¢y v·ªè ƒë·ªè / Red potatoes", unit: "kg", qty: 10 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "B√≠ ƒë·ªè / Pumpkin", unit: "Qu·∫£", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·ªß d·ªÅn to tr√≤n / Beetroot (Big & Round)", unit: "C·ªß", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "·ªöt hi·ªÉm ƒë·ªè / Bird's eye chili", unit: "VNƒê", qty: "15k" },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "B·∫Øp m·ªπ / Yellow corn", unit: "Tr√°i", qty: 3 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "Chanh n∆∞·ªõc c√≥ h·∫°t / Lime (with seeds)", unit: "kg", qty: 1.5 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "·ªöt chu√¥ng xanh / Green capsicum", unit: "kg", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "·ªöt chu√¥ng ƒë·ªè / Red capsicum", unit: "kg", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "Ti√™u xanh / Green peppecorn", unit: "H·ªôp", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "N·∫•m r∆°m / Straw mushroom", unit: "kg", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "N·∫•m h∆∞∆°ng / Shiitake mushroom", unit: "B·ªãch", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "Ng√≤ t√¢y / Parsley", unit: "Gram", qty: 150 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "H∆∞∆°ng th·∫£o / Rosemary", unit: "B·ªãch", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·∫ßn t√¢y √©p n∆∞·ªõc / Celery", unit: "C·ªçng", qty: 2 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "T·ªèi nguy√™n c·ªß / Whole garlic", unit: "C·ªß", qty: 20 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "T·ªèi xay nhuy·ªÖn / Minced garlic", unit: "VNƒê", qty: "15k" },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·ªß c·∫£i tr·∫Øng / White turnip", unit: "C·ªß", qty: 3 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "G·ª´ng / Ginger", unit: "C·ªß", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "X·∫£ / Lemongrass", unit: "VNƒê", qty: "20k" },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·∫£i th·∫£o / Chinese cabbage", unit: "C·ªçng", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "C·∫£i th√¨a / Bok choy", unit: "Gram", qty: 500 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "Th√¨ l√† / Dill", unit: "VNƒê", qty: "10k" },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "Th∆°m / Pineapple", unit: "Tr√°i", qty: 1 },
            { cat: "RAU C·ª¶ / PRODUCE (VEG)", name: "ƒê·∫≠u h≈© chi√™n / Fried tofu", unit: "H·ªôp", qty: 2 },

            // FRESH PROTEIN
            { cat: "TH·ªäT T∆Ø∆†I / FRESH PROTEIN", name: "M·ª° heo / Pork fat", unit: "kg", qty: 2 },
            { cat: "TH·ªäT T∆Ø∆†I / FRESH PROTEIN", name: "C√° ch·∫Ωm / Sea bass", unit: "kg", qty: 10 },
            { cat: "TH·ªäT T∆Ø∆†I / FRESH PROTEIN", name: "·ª®c g√† / Chicken breast", unit: "kg", qty: 5 },
            { cat: "TH·ªäT T∆Ø∆†I / FRESH PROTEIN", name: "X∆∞∆°ng g√† / Chicken bones", unit: "kg", qty: 5 },
            { cat: "TH·ªäT T∆Ø∆†I / FRESH PROTEIN", name: "T√¥m / Shrimp", unit: "kg", qty: 2 },
            { cat: "TH·ªäT T∆Ø∆†I / FRESH PROTEIN", name: "M·ª±c / Squid", unit: "kg", qty: 3 },
            { cat: "TH·ªäT T∆Ø∆†I / FRESH PROTEIN", name: "N·∫°c dƒÉm / Pork shoulder", unit: "kg", qty: 12 },

            // DAIRY
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Tr·ª©ng / Eggs", unit: "Qu·∫£", qty: 150 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "B∆° (vi√™n) / Butter cubes", unit: "H·ªôp", qty: 5 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "B∆° (Kh·ªëi) / Block butter", unit: "kg", qty: 5 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Kem n·∫•u ƒÉn / Cooking cream", unit: "H·ªôp", qty: 6 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Ph√¥ mai Cheddar / Cheddar cheese", unit: "B·ªãch", qty: 5 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Ph√¥ mai Parmesan / Parmesan cheese", unit: "B·ªãch", qty: 1 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Ph√¥ mai xanh / Blue cheese", unit: "C√°i", qty: 1 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Ph√¥ mai Brie / Brie cheese", unit: "H·ªôp", qty: 12 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Ph√¥ mai Swiss Emmental / Emmental cheese", unit: "C√¢y", qty: 1 },
            { cat: "S·ªÆA & TR·ª®NG / DAIRY & EGGS", name: "Ph√¥ mai B√≤ C∆∞·ªùi / Laughing Cow cheese", unit: "H·ªôp", qty: 1 },

            // FROZEN
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "Pepperoni", unit: "B·ªãch", qty: 15 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "X√∫c x√≠ch / Sausages", unit: "B·ªãch", qty: 7 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "B√≤ steak / Beef steak", unit: "kg", qty: 12 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "Roast beef", unit: "kg", qty: 12 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "Th·ªãt x√¥ng kh√≥i / Bacon", unit: "B·ªãch", qty: 30 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "ƒê√πi c·ª´u / Lamb leg", unit: "kg", qty: 12 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "ƒê·∫≠u pea / Peas", unit: "B·ªãch", qty: 3 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "Ph√¥ mai Mozzarella / Mozzarella", unit: "Th√πng", qty: 4 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "Khoai ƒë√¥ng l·∫°nh shoestring / Fries", unit: "Th√πng", qty: 2 },
            { cat: "ƒê√îNG L·∫†NH / FROZEN", name: "Vi·ªát qu·∫•t / Blueberry", unit: "B·ªãch", qty: 3 },

            // DRY STORE
            { cat: "KHO / DRY STORE", name: "Ti√™u ƒëen / Black pepper", unit: "Gram", qty: 500 },
            { cat: "KHO / DRY STORE", name: "Mu·ªëi Iod / Iodine Salt", unit: "B·ªãch", qty: 2 },
            { cat: "KHO / DRY STORE", name: "ƒê∆∞·ªùng / Sugar", unit: "B·ªãch", qty: 1 },
            { cat: "KHO / DRY STORE", name: "H·∫°t n√™m x∆∞∆°ng Aji-ngon / Seasoning", unit: "B·ªãch", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt nƒÉng / Corn starch", unit: "B·ªãch", qty: 2 },
            { cat: "KHO / DRY STORE", name: "Gi·∫•m / Vinegar", unit: "Chai", qty: 2 },
            { cat: "KHO / DRY STORE", name: "D·∫ßu h√†u / Oyster sauce", unit: "Chai", qty: 1 },
            { cat: "KHO / DRY STORE", name: "N∆∞·ªõc t∆∞∆°ng / Soya sauce", unit: "Chai", qty: 1 },
            { cat: "KHO / DRY STORE", name: "H·∫°t ƒëi·ªÅu / Cashew", unit: "Gram", qty: 200 },
            { cat: "KHO / DRY STORE", name: "B·ªôt ·ªõt / Chili flakes", unit: "H·ªß", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt t·ªèi / Garlic powder", unit: "H·ªß", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt h√†nh / Onion powder", unit: "H·ªß", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt c√† ri Babas / Curry powder", unit: "B·ªãch", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt chi√™n gi√≤n / Frying powder", unit: "B·ªãch", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt chi√™n x√π / Breadcrumbs", unit: "Kg", qty: 20 },
            { cat: "KHO / DRY STORE", name: "Baked beans Ayam", unit: "H·ªôp", qty: 6 },
            { cat: "KHO / DRY STORE", name: "D·∫ßu ƒÉn C√°i L√¢n / Cooking oil", unit: "Th√πng", qty: 1 },
            { cat: "KHO / DRY STORE", name: "G·∫°o ST25 / Rice ST25", unit: "Kg", qty: 10 },
            { cat: "KHO / DRY STORE", name: "D·∫ßu √¥ liu / Olive oil", unit: "Chai", qty: 1 },
            { cat: "KHO / DRY STORE", name: "C√† chua l∆∞·ª£t v·ªè / Peeled tomatoes", unit: "Th√πng", qty: 2 },
            { cat: "KHO / DRY STORE", name: "Tomato paste", unit: "Th√πng", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt Pancake / Pancake mix", unit: "H·ªôp", qty: 2 },
            { cat: "KHO / DRY STORE", name: "B·ªôt s·ªët gravy / Gravy mix", unit: "H·ªôp", qty: 2 },
            { cat: "KHO / DRY STORE", name: "N∆∞·ªõc c·ªët d·ª´a / Coconut milk", unit: "H·ªôp", qty: 2 },
            { cat: "KHO / DRY STORE", name: "ƒê·∫≠u g√† / Chickpeas", unit: "H·ªôp", qty: 2 },
            { cat: "KHO / DRY STORE", name: "T∆∞∆°ng c√† (G√≥i) / Ketchup sachets", unit: "Th√πng", qty: 1 },
            { cat: "KHO / DRY STORE", name: "T∆∞∆°ng ·ªõt (G√≥i) / Chili sachets", unit: "Th√πng", qty: 1 },
            { cat: "KHO / DRY STORE", name: "R∆∞·ª£u vang ƒë·ªè Classic Dalat / Dalat Wine", unit: "Chai", qty: 2 },
            { cat: "KHO / DRY STORE", name: "B·ªôt m√¨ ƒë·ªãa c·∫ßu 999 / Wheat flour", unit: "Bao", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt m√¨ Semolina / Semolina flour", unit: "B·ªãch", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B∆° th∆°m / Margarine", unit: "Gram", qty: 500 },
            { cat: "KHO / DRY STORE", name: "B·ªôt b√©o H√† Lan / Creamer powder", unit: "B·ªãch", qty: 2 },
            { cat: "KHO / DRY STORE", name: "Ph·ª• gia b√°nh m√¨ Baker 999 / Additive", unit: "B·ªãch", qty: 2 },
            { cat: "KHO / DRY STORE", name: "B·ªôt nƒÉng khoai / Tapioca powder", unit: "B·ªãch", qty: 2 },
            { cat: "KHO / DRY STORE", name: "Fibrisol (ham)", unit: "B·ªãch", qty: 1 },
            { cat: "KHO / DRY STORE", name: "Mu·ªëi ƒë·ªè h·ªìng (ham) / Pink salt", unit: "B·ªãch", qty: 1 },

            // JARS & SAUCES
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "√î liu ƒëen kh√¥ng h·∫°t / Pitted olives", unit: "H·ªôp", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "N·ª• b·∫°ch hoa / Capers", unit: "H·ªôp", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "D∆∞a chu·ªôt mu·ªëi / Pickles", unit: "H·ªôp", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "·ªöt Jalapenos / Jalapenos", unit: "Chai", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "M√π t·∫°t v√†ng / Yellow mustard", unit: "Chai", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "Wasabi / Green mustard", unit: "C√°i", qty: 2 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "Mayonnaise", unit: "H·ªôp", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "Maple syrup", unit: "Chai", qty: 2 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "S·ªët BBQ / BBQ sauce", unit: "Chai", qty: 2 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "Jam vi·ªát qu·∫•t / Blueberry jam", unit: "H·ªß", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "Nutella", unit: "H·ªß", qty: 1 },

            // PACKAGING
            { cat: "BAO B√å / PACKAGING", name: "H·ªôp x·ªëp (L·ªõn) / Large styrofoam box", unit: "L·ªëc", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "H·ªôp x·ªëp (Nh·ªè) / Small styrofoam box", unit: "L·ªëc", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "H·ªôp nh·ª±a ƒë·ª±ng s·ªët / Sauce container", unit: "L·ªëc", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "H·ªôp nh·ª±a syrup / Syrup container", unit: "L·ªëc", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "H·ªôp nh·ª±a 750ml (s√∫p) / Soup container", unit: "L·ªëc", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "H·ªôp ƒë·ª±ng pizza / Pizza boxes", unit: "C√°i", qty: 500 },
            { cat: "BAO B√å / PACKAGING", name: "Bao t√¢y nilon / Plastic gloves", unit: "L·ªëc", qty: 3 },
            { cat: "BAO B√å / PACKAGING", name: "B·ªãch chia 17x27 / Portioning bags", unit: "kg", qty: 3 },
            { cat: "BAO B√å / PACKAGING", name: "B·ªãch mang v·ªÅ 15kg / Takeaway bag 15kg", unit: "kg", qty: 3 },
            { cat: "BAO B√å / PACKAGING", name: "B·ªãch mang v·ªÅ 10kg / Takeaway bag 10kg", unit: "kg", qty: 3 },
            { cat: "BAO B√å / PACKAGING", name: "B·ªãch mang v·ªÅ 5kg / Takeaway bag 5kg", unit: "kg", qty: 3 },
            { cat: "BAO B√å / PACKAGING", name: "B·ªãch mang v·ªÅ 3kg / Takeaway bag 3kg", unit: "kg", qty: 3 },
            { cat: "BAO B√å / PACKAGING", name: "B·ªãch r·∫Øc ƒëen 30kg / Garbage bag 30kg", unit: "kg", qty: 3 },
            { cat: "BAO B√å / PACKAGING", name: "Gi·∫•y vu√¥ng burger 33cm / Burger paper", unit: "kg", qty: 2 },
            { cat: "BAO B√å / PACKAGING", name: "Gi·∫•y n·∫øn n∆∞·ªõng / Oven paper", unit: "H·ªôp", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "M√†ng PE b·∫øp / Plastic wrap", unit: "H·ªôp", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "Gi·∫•y b·∫°c / Aluminium wrap", unit: "H·ªôp", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "D√¢y chun / Rubber band", unit: "B·ªãch", qty: 1 },
            { cat: "BAO B√å / PACKAGING", name: "Xi√™n tre / Bamboo sticks", unit: "B·ªãch", qty: 1 },

            // SUPPLIES
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "N∆∞·ªõc r·ª≠a ch√©n / Dishwashing liquid", unit: "Th√πng", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "N∆∞·ªõc l√¢u nh√† / Floor detergent", unit: "B√¨nh", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "N∆∞·ªõc l√¢u b·∫øp / Kitchen spray", unit: "Chai", qty: 1 }
        ];

        const floorData = [
            // BEVERAGE
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "S·ªØa t∆∞∆°i / Fresh milk", unit: "Th√πng", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "S·ªØa ƒë·∫∑c h·ªôp nh·ªè / Condensed milk", unit: "H·ªôp", qty: 10 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "C√† ph√™ Vi·ªát Nam / VN Coffee", unit: "kg", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Nescafe ƒê·ªè / Nescafe Red", unit: "H·ªôp", qty: 2 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Tr√† Lipton / Tea bags", unit: "H·ªôp", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "ƒê∆∞·ªùng qu√™ / Sugar sticks", unit: "B·ªãch", qty: 3 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Tiger / Tiger Crystal", unit: "K√©t", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Saigon Green / Red", unit: "K√©t", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "San Miguel", unit: "K√©t", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Coke", unit: "Th√πng", qty: 3 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Coke light", unit: "Th√πng", qty: 2 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "7Up", unit: "Th√πng", qty: 2 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Soda", unit: "Th√πng", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Aqua 500ml", unit: "Th√πng", qty: 3 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "R∆∞·ª£u Table Mountain Red", unit: "Chai", qty: 2 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "R∆∞·ª£u Table Mountain White", unit: "Chai", qty: 2 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Jack Daniels", unit: "Chai", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Captain Morgan", unit: "Chai", qty: 1 },
            { cat: "ƒê·ªí U·ªêNG / BEVERAGE", name: "Vodka", unit: "Chai", qty: 2 },

            // JARS & SAUCES
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "N∆∞·ªõc s·ªët HP / HP sauce", unit: "Chai", qty: 3 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "N∆∞·ªõc s·ªët Worcestershire", unit: "Chai", qty: 3 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "Sriracha", unit: "Chai", qty: 3 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "N∆∞·ªõc t∆∞∆°ng chai nh·ªè / Soya sauce", unit: "Chai", qty: 3 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "T∆∞∆°ng ·ªõt chai / Chili sauce", unit: "Th√πng", qty: 1 },
            { cat: "GIA V·ªä & S·ªêT / JARS & SAUCES", name: "T∆∞∆°ng c√† chai / Ketchup bottle", unit: "Th√πng", qty: 1 },

            // DRY STORE
            { cat: "KHO / DRY STORE", name: "Mu·ªëi kho b√†n / Table salt", unit: "B·ªãch", qty: 1 },
            { cat: "KHO / DRY STORE", name: "H·∫°nh nh√¢n 300g / Almonds", unit: "H·ªß", qty: 1 },
            { cat: "KHO / DRY STORE", name: "Whey", unit: "H·ªß", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B·ªôt cacao / Cocoa powder", unit: "H·ªß", qty: 1 },
            { cat: "KHO / DRY STORE", name: "B√°nh ladyfingers / Biscuits", unit: "B·ªãch", qty: 2 },
            { cat: "KHO / DRY STORE", name: "M·∫≠t ong / Honey", unit: "Chai", qty: 1 },
            { cat: "KHO / DRY STORE", name: "Y·∫øn m·∫°ch / Oats", unit: "H·ªß", qty: 1 },
            { cat: "KHO / DRY STORE", name: "Da ua / Yogurt", unit: "H·ªôp", qty: 6 },

            // FRUIT
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "Qu·∫£ cam / Orange", unit: "kg", qty: 10 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "Xo√†i ch√≠n / Mango ripened", unit: "Qu·∫£", qty: 8 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "D∆∞a h·∫•u / Watermelon", unit: "Qu·∫£", qty: 1 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "Chu·ªëi / Banana", unit: "kg", qty: 1 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "Chanh d√¢y / Passion fruit", unit: "kg", qty: 2 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "D·ª´a / Coconut", unit: "Qu·∫£", qty: 20 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "·ªîi / Guava", unit: "kg", qty: 1 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "Th∆°m / Pineapple", unit: "Qu·∫£", qty: 1 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "B∆° / Avocado", unit: "Qu·∫£", qty: 2 },
            { cat: "TR√ÅI C√ÇY / FRUIT", name: "Chanh n∆∞·ªõc c√≥ h·∫°t / Lime", unit: "kg", qty: 1 },

            // SUPPLIES
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "Gi·∫•y l·ª•a / Tissues", unit: "B·ªãch", qty: 5 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "TƒÉm x·ªâa rƒÉng / Toothpicks", unit: "H·ªôp", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "KhƒÉn ƒÉn vu√¥ng / Napkins", unit: "B·ªãch", qty: 5 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "·ªêng h√∫t / Straws", unit: "B·ªãch", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "Ly gi·∫•y 500ml / Paper cups", unit: "L·ªëc", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "N·∫Øp ly gi·∫•y / Paper lids", unit: "L·ªëc", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "T√∫i quai T / Carrier", unit: "L·ªëc", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "Nhang mu·ªói / Repellant", unit: "L·ªëc", qty: 1 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "H·ªôp qu·∫πt / Lighter", unit: "C√°i", qty: 2 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "B√∫t / Pen", unit: "C√°i", qty: 10 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "B√∫t b·∫£ng ƒëen / Blackboard marker", unit: "C√°i", qty: 2 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "B√∫t d·∫° vƒ©nh c·ª≠u / Permanent marker", unit: "C√°i", qty: 2 },
            { cat: "V·∫¨T T∆Ø / SUPPLIES", name: "Gi·∫•y in bill 80mm / Receipt paper", unit: "Cu·ªën", qty: 5 }
        ];

        let currentTab = 'kitchen';
        let selections = new Map(); 

        function renderList() {
            const list = document.getElementById('inventory-list');
            list.innerHTML = '';
            const data = currentTab === 'kitchen' ? kitchenData : floorData;
            
            let currentCat = '';
            data.forEach((item, index) => {
                if (item.cat !== currentCat) {
                    currentCat = item.cat;
                    list.innerHTML += `<div class="category-header">${currentCat}</div>`;
                }

                const itemId = `${currentTab}-${index}`;
                const isChecked = selections.has(itemId);
                const currentVal = isChecked ? selections.get(itemId) : item.qty;
                const bgClass = isChecked ? 'bg-blue-50 border-blue-300' : 'bg-white border-gray-200';
                const opacityClass = isChecked ? 'opacity-100' : 'opacity-20';

                list.innerHTML += `
                    <div id="row-${itemId}" class="item-row flex items-center p-3 border border-t-0 bg-white ${bgClass} transition-all duration-200 shadow-sm first:rounded-t-none last:rounded-b-lg">
                        <div class="flex items-center justify-center mr-3" onclick="toggleItem('${itemId}', '${item.qty}')">
                            <input type="checkbox" id="check-${itemId}" ${isChecked ? 'checked' : ''} class="pointer-events-none w-5 h-5">
                        </div>
                        <div class="flex-grow" onclick="toggleItem('${itemId}', '${item.qty}')">
                            <div class="font-bold text-gray-800 text-sm leading-tight">${item.name}</div>
                        </div>
                        <div class="flex flex-col items-center ${opacityClass} transition-opacity">
                            <input type="text" id="qty-${itemId}" 
                                   value="${currentVal}" 
                                   class="qty-input focus:ring-2 focus:ring-blue-500 outline-none shadow-inner"
                                   onchange="updateQty('${itemId}', this.value)"
                                   onclick="event.stopPropagation()">
                            <div class="text-[10px] text-gray-400 uppercase font-black mt-1 leading-none">${item.unit}</div>
                        </div>
                    </div>
                `;
            });
            updateCount();
        }

        function toggleItem(id, defaultQty) {
            const row = document.getElementById(`row-${id}`);
            const checkbox = document.getElementById(`check-${id}`);
            const inputContainer = row.querySelector('.flex.flex-col.items-center');
            
            if (selections.has(id)) {
                selections.delete(id);
                row.classList.remove('bg-blue-50', 'border-blue-300');
                checkbox.checked = false;
                inputContainer.classList.add('opacity-20');
            } else {
                selections.set(id, defaultQty);
                row.classList.add('bg-blue-50', 'border-blue-300');
                checkbox.checked = true;
                inputContainer.classList.remove('opacity-20');
            }
            updateCount();
        }

        function updateQty(id, newVal) {
            selections.set(id, newVal);
            const row = document.getElementById(`row-${id}`);
            if (!document.getElementById(`check-${id}`).checked) {
                document.getElementById(`check-${id}`).checked = true;
                row.classList.add('bg-blue-50', 'border-blue-300');
                row.querySelector('.flex.flex-col.items-center').classList.remove('opacity-20');
            }
            updateCount();
        }

        function switchTab(tab) {
            currentTab = tab;
            document.getElementById('btn-kitchen').className = tab === 'kitchen' ? 'pb-2 px-4 tab-active' : 'pb-2 px-4 text-gray-500';
            document.getElementById('btn-floor').className = tab === 'floor' ? 'pb-2 px-4 tab-active' : 'pb-2 px-4 text-gray-500';
            document.getElementById('searchInput').value = '';
            renderList();
        }

        function updateCount() {
            document.getElementById('selected-count').innerText = selections.size;
        }

        function filterItems() {
            const val = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('.item-row');
            rows.forEach(row => {
                const text = row.innerText.toLowerCase();
                row.style.display = text.includes(val) ? 'flex' : 'none';
            });
            const headers = document.querySelectorAll('.category-header');
            headers.forEach(h => {
                let sibling = h.nextElementSibling;
                let hasVisible = false;
                while (sibling && sibling.classList.contains('item-row')) {
                    if (sibling.style.display !== 'none') hasVisible = true;
                    sibling = sibling.nextElementSibling;
                }
                h.style.display = hasVisible ? 'block' : 'none';
            });
        }

        function generateOrder() {
            if (selections.size === 0) {
                alert("Please select items!");
                return;
            }

            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
            let message = `üõí REQUISITION - ${now.toLocaleDateString()} (${timeStr})\n`;
            message += `==========================\n`;

            const kitchenLines = [];
            const floorLines = [];

            kitchenData.forEach((item, index) => {
                const id = `kitchen-${index}`;
                if (selections.has(id)) kitchenLines.push(`‚Ä¢ ${item.name}: ${selections.get(id)} ${item.unit}`);
            });
            floorData.forEach((item, index) => {
                const id = `floor-${index}`;
                if (selections.has(id)) floorLines.push(`‚Ä¢ ${item.name}: ${selections.get(id)} ${item.unit}`);
            });

            if (kitchenLines.length > 0) message += `\n[KITCHEN / B·∫æP]\n` + kitchenLines.join('\n') + `\n`;
            if (floorLines.length > 0) message += `\n[FLOOR & BAR]\n` + floorLines.join('\n') + `\n`;

            const encodedMsg = encodeURIComponent(message);
            window.location.href = `whatsapp://send?phone=84364663202&text=${encodedMsg}`;
            
            setTimeout(() => {
                const temp = document.createElement('textarea');
                temp.value = message;
                document.body.appendChild(temp);
                temp.select();
                document.execCommand('copy');
                document.body.removeChild(temp);
                alert("Order copied to clipboard! Paste it into WhatsApp, Zalo, or SMS to send.");
            }, 800);
        }

        // --- REFRESH WARNING LOGIC ---
        function closeModal() {
            document.getElementById('refresh-modal').style.display = 'none';
        }

        // Standard browser beforeunload to prevent accidental tab closing/refreshing
        window.addEventListener('beforeunload', (e) => {
            if (selections.size > 0) {
                // Browsers show their own native prompt here
                e.preventDefault();
                e.returnValue = '';
            }
        });

        // Detect manual swipe-to-refresh on mobile if possible
        let touchStart;
        window.addEventListener('touchstart', function(e) {
            touchStart = e.touches[0].pageY;
        }, {passive: true});

        window.addEventListener('touchmove', function(e) {
            const touchMove = e.touches[0].pageY;
            // If pulling down at the top of the page
            if (window.scrollY === 0 && touchMove > touchStart + 10 && selections.size > 0) {
                // We show a custom modal because beforeunload doesn't always catch swipe-to-refresh
                // This is a "soft" warning
                document.getElementById('refresh-modal').style.display = 'flex';
            }
        }, {passive: true});

        window.onload = renderList;
    </script>
</body>
</html>
